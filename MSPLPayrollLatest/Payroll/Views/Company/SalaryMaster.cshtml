<form id="@Session["EmployeeGUID"]">
    <div class="form-horizontal">
        <div class="form-group">
            <label class="control-label col-md-2">
                BASIC PAY
            </label>
            <div class="col-md-2 ">
                <input id="basic" disabled type="text" class="form-control col-md-2">
                <br /><br />
            </div>

            <div class="col-md-2">
                <input id="basicMonth" data-id="a01fc9a8-5842-4ae4-b62a-7808cfbe3e7e" disabled type="text" class="form-control col-md-2">
                <br /><br />
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">
                FLEXIBLE ALLOWANCE
            </label>
            <div class="col-md-2">
                <input id="flexible" data-id="d65f39a0-1655-4865-9c3a-8d633b9226a5" disabled="" type="text" class="form-control col-md-4">
            </div>
            <input id="flexiValue" style="visibility:hidden" type="text">
        </div>
    </div>
</form>
<div class="col-md-11">
    <input type="button" onclick="$FlexiPay.editFlexiPay()" id="btnEditFlexi" value="Edit" class="btn custom-button btnRight marginbt7">
</div>
<div class="col-md-1">
    <input type="button" onclick="$FlexiPay.saveFlexiPay()" id="btnSaveFlexi" value="Save" class="btn custom-button btnRight marginbt7">
</div>
<div class="col-md-12 table-responsive">
    <table id="tblFlexiPay" data-entity="" data-modelid="" class="table table-responsive table-striped table-hover table-condensed userTablehand dataTable no-footer">
        <thead>
            <tr>
                <th>Component</th>
                <th>Opting (Yes/No)</th>
                <th>Per Annum</th>
                <th>Per Month</th>
                <th>Input Per Annum</th>
                <th>Validation Check</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    HRA
                </td>
                <td>
                    <select id="hraSelec" onchange="$FlexiPay.changeInput(this.id, this.value)" class="opting-select">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumHra" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="e490ce0e-d8ef-4088-899d-270f204e4a5c" id="perMonthHra" disabled class="input-annu"></td>
                <td>
                    <input id="annuHra" autocomplete="off" onchange="$FlexiPay.changedval(this.id,this.event)" oninput="$FlexiPay.checkValue(event ,this.id)" type="text" class="input-annum">
                </td>
                <td>
                    <label id="hraSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    LTA
                </td>
                <td>
                    <select id="ltaSelec" onchange="$FlexiPay.changeInput(this.id, this.value)" class="opting-select">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumLta" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="21e1b02a-b855-440e-8556-a31195ce5265" id="perMonthLta" disabled class="input-annu"></td>
                <td>
                    <input type="text" autocomplete="off" onchange="$FlexiPay.changedval(this.id,this.event)" oninput="$FlexiPay.checkValue(event ,this.id)" id="annuLta" class="input-annum">
                </td>
                <td>
                    <label id="ltaSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    Gift Voucher
                </td>
                <td>
                    <select id="giftSelec" onchange="$FlexiPay.selectDefaultValue(this.id, this.value)" class="opting-select">

                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumGift" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="4f7ab84f-8fe2-41e4-99f4-ec0e863d5146" id="perMonthGift" disabled class="input-annu"></td>
                <td>
                    <input type="text" autocomplete="off" id="annuGift" style="background-color: lightgray;" class="input-annum" disabled>
                </td>
                <td>
                    <label id="giftSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    Education Allowance
                </td>
                <td>
                    <select id="eduSelec" onchange="$FlexiPay.selectDefaultValue(this.id, this.value)" class="opting-select">

                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumEdu" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="71f0fba7-e70c-4951-b967-69430740af37" id="perMonthEdu" disabled class="input-annu"></td>
                <td>
                    <input type="text" id="annuEdu" autocomplete="off" style="background-color: lightgray;" class="input-annum" disabled>
                </td>
                <td>
                    <label id="eduSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    Meal Voucher
                </td>
                <td>
                    <select id="mealSelec" onchange="$FlexiPay.selectDefaultValue(this.id, this.value)" class="opting-select">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumMeal" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="a22caa37-ffe2-496e-a31d-ad8733b4a1e1" id="perMonthMeal" disabled class="input-annu"></td>
                <td>
                    <input type="text" id="annuMeal" autocomplete="off" style="background-color: lightgray;" class="input-annum" disabled>
                </td>
                <td>
                    <label id="mealSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    Conveyance
                </td>
                <td>
                    <select id="convSelec" onchange="$FlexiPay.selectDefaultValue(this.id, this.value)" class="opting-select">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumConv" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="c47c2530-424a-4f9f-8c12-87ad8a365a57" id="perMonthConv" disabled class="input-annu"></td>
                <td>
                    <input type="text" autocomplete="off" id="annuConv" style="background-color: lightgray;" class="input-annum" disabled>
                </td>
                <td>
                    <label id="convSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    NPS
                </td>
                <td>
                    <select id="npsSelec" onchange="$FlexiPay.changeInput(this.id, this.value)" class="opting-select">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumNps" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="c7b980de-1920-425b-aee4-ae4e0136ab6c" id="perMonthNps" disabled class="input-annu"></td>
                <td>
                    <input type="text" autocomplete="off" onchange="$FlexiPay.changedval(this.id,this.event)" oninput="$FlexiPay.checkValue(event ,this.id)" id="annumNps" class="input-annum">
                </td>
                <td>
                    <label id="npsSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    Telecom Allowance
                </td>
                <td>
                    <select id="teleSelec" onchange="$FlexiPay.changeInput(this.id, this.value)" class="opting-select">

                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumTele" disabled class="input-perAnnum"></td>
                <td> <input value="" data-id="f7565dfd-775d-4350-94c0-d4287f167b0b" type="text" id="perMonthTele" disabled class="input-annum"></td>
                <td>
                    <input type="text" autocomplete="off" onchange="$FlexiPay.changedval(this.id,this.event)" oninput="$FlexiPay.checkValue(this.event,this.id)" id="annuTele" class="input-annum">
                </td>
                <td>
                    <label id="teleSpan" class="validation-check"> </label>
                </td>
            </tr>
            <tr>
                <td>
                    Special Allowance
                </td>
                <td>
                    <select id="splSelec" disabled class="opting-select">
                        <option value="yes">Yes</option>
                    </select>
                </td>
                <td>   <input type="text" id="perAnnumSpl" disabled class="input-perAnnum"></td>
                <td> <input type="text" value="" data-id="777d7091-b993-4572-80e9-78678276575e" id="perMonthSpl" disabled class="input-annu"></td>
                <td>
                    <input id="annuSpl" autocomplete="off" type="text" style="background-color: lightgray;" class="input-annum" disabled>
                </td>
                <td>
                    <label id="splSpan" class="validation-check"> </label>
                </td>
            </tr>
        </tbody>
    </table>
    <input type="text" disabled id="splCalcu" style="display:none" />
</div>
<div class="col-md-12" id="netSalaryCalcu">

    <br />
    <div class="col-sm-12">
        <div class="col-sm-6">
            <div class="form-group">
                <label class="control-label col-md-4">
                    EARNED GROSS
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="erGross" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
            <div>
                <br>
                <br>
            </div>


            <div class="form-group">
                <label class="control-label col-md-4">
                    TOTAL DEDCUCTION
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="totalDedcu" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
            <div>
                <br>
                <br>
            </div>
            <div class="form-group">
                <label class="control-label col-md-4">
                    NETPAY BEFORE TAX
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="netPay" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="form-group">
                <label class="control-label col-md-4">
                    GIFT VOUCHER
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="txtGift" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
            <div>
                <br>
                <br>
            </div>
            <div class="form-group">
                <label class="control-label col-md-4">
                    MEAL VOUCHER
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="txtMeal" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
            <div>
                <br>
                <br>
            </div>
            <div class="form-group">
                <label class="control-label col-md-4">
                    NPS
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="txtNps" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
            <div>
                <br>
                <br>
            </div>
            <div class="form-group">
                <label class="control-label col-md-4">
                    PF
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="PFtxt" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
            <div>
                <br>
                <br>
            </div>


            <div class="form-group">
                <label class="control-label col-md-4">
                    LWF
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="LWF" value="20" placeholder="Name" required="" readonly 100="">
                </div>
            </div>
            <div>
                <br>
                <br>
            </div>
            <div class="form-group">
                <label class="control-label col-md-4">
                    PROF. TAX
                </label>
                <div class="col-md-7">
                    <input type="text" class="form-control" id="PTAX" value="0" placeholder="Name" required="" readonly 100="">
                </div>
            </div>

        </div>
    </div>
</div>
<script src="~/Js/FlexiPay.js"></script>
<script>
    $(document).ready(function () {
        $("#netSalaryCalcu").hide();
        $('#tblFlexiPay').DataTable({
            'paging': false,
            'searching': false,
            'ordering': false,
            'info': false,
            'columnDefs': [

                { 'className': 'opting-select', 'targets': 1 },
                { 'className': 'input-annum', 'targets': 4 },
                { 'className': 'validation-check', 'targets': 5 }
            ]
        });

    });
    $(document).ready(function () {
        $.ajax({
            url: $app.baseUrl + "Entity/GetMasterValue",
            contentType: 'application/json; charset=utf-8',
            type: "GET",
            contentType: false,
            cache: false,
            processData: false,
            success: function (jsonResult) {
                debugger;
                if (jsonResult.Status) {
                    var result = jsonResult.result;
                    $app.showAlert(jsonResult.Message, 2)
                    var currentDate = new Date();
                    var month = currentDate.getMonth() + 1; // Months are zero-based, so add 1
                    var year = currentDate.getFullYear();
                   
                    var currentYearMonth = month + '-' + year;
                    var basicmonth = Math.ceil(result.basicPay * 12);
                    $("#flexible").val(result.FlexPay);
                    $("#flexiValue").val(result.FlexPay);
                    $("#basic").val(basicmonth);
                    if (result.basicPay !== undefined) {
                        $("#basicMonth").val(Math.ceil(basicmonth / 12));
                    }
                    var saveCheck = $('#flexible').val();

                    if (result.FlexPay !== "0" && result.FlexPay !== NaN && result.FlexPay !== undefined) {
                        $("#perAnnumSpl").val(result.FlexPay);
                        $("#annuSpl").val(result.FlexPay);
                        $("#perMonthSpl").val(Math.ceil(result.FlexPay / 12));

                    }//result.PayrollProc === true &&
                    if ((Date.parse(result.CutOffDate) >= Date.now() && result.PayrollProc) || (Date.parse(result.CutOffDate) >= Date.now() && result.IsIncrement == currentYearMonth ) ) {
                        debugger



                        $("#btnSaveFlexi").show();

                        $("#btnEditFlexi").hide();

                    } else {

                        $("#btnSaveFlexi").hide();
                        $("#btnEditFlexi").hide();
                    }
                    if (saveCheck === '0') {
                        $(".opting-select").prop("disabled", true);
                        $("#btnSaveFlexi").hide();
                        $("#btnEditFlexi").show();
                        $FlexiPay.LoadData();
                        $FlexiPay.calcuNetPay();
                    }
                    $FlexiPay.LoadData();


                }
                else {
                    $app.showAlert("Loading faild", 4)
                    
                }
            }
        })
    });
</script>
@section Scripts{

    <script src="~/Js/FlexiPay.js"></script>
    <script src="~/Js/Company/entityMapping.js"></script>
}



