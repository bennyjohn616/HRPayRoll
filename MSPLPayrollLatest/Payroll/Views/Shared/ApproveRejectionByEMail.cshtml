@model Payroll.Controllers.UserMenu
@{
    Layout = null;
    var appstatus = ViewData["sucessstatus"] as Payroll.Controllers.emailapproval;
}

<!DOCTYPE html>
<script type="text/javascript" language="javascript">
        $rootUrl = "@Url.Content("~/")";
        //alert($rootUrl);
</script>
<script src="~/assets/plugins/ModalPopups.js"></script>
<script src="~/assets/js/jquery-1.11.2.js"></script>
<script src="~/Js/Admin/User.js" type="text/javascript"></script>
<script src="~/Js/Company/CompanyCom.js" type="text/javascript"></script>
<script src="~/Js/Leave/leaveRequest.js" type="text/javascript"></script>
<script src="~/Js/application.js"></script>
@Scripts.Render("~/Js/Leave/leaveRequest.js")
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="~/assets/css/main.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet"
          type="text/css" />
    <script src="~/assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <title>ApproveRejectionByEMail</title>
    <script src="~/Js/Admin/User.js" type="text/javascript"></script>
</head>
<body class="body-border" style="background: linear-gradient(rgb(173, 232, 189), #6d986e);">
    <div class="col-md-12">
        <ul class="nav navbar-nav navbar-right">
            <li class="logo-back"></li>
        </ul>
    </div>
    <div class="container login-box" style="background-color:white;margin-top:25px; box-shadow: 3px 3px 5px 6px #0b2a0f; margin-top:100px; height:130px;">

        <input id="hdnassgnmngrid" name="hiddenId1" type="hidden" value=@appstatus.assgnmngrid />
        <input id="hdnLeaveid" name="hiddenId2" type="hidden" value=@appstatus.Leaveid />
        <input id="hdnprioritynum" name="hiddenId3" type="hidden" value=@appstatus.prioritynum />
        <input id="hdnAorRstat" name="hiddenId4" type="hidden" value=@appstatus.AorRstat />
        <input id="hdnstatus" name="hiddenId5" type="hidden" value=@appstatus.status />
        <input id="hdnNavTab" name="hiddenId6" type="hidden" value=@appstatus.NavTab />
        @if (Model.emailapprvalproperty.appstatus == 2)
        {
            <div class="form-group" id="idrejectiondiv">
                <div class="form-group">
                    <label class="control-label">
                        Reason <label style="color:red;font-size: 13px">*</label>
                    </label>
                    <div>
                        <input type="text" id="txtRejreasonbymail" class="form-control Reqrd" placeholder="Enter the Reason"
                               required />
                        </div>
                    </div>
                <div>
                    <div>
                        <input type="button" id="btnRejectbymail" value="Reject" class="btn custom-button pull-right " onclick="BTNrejbymail()" />
                    </div>

                </div>

            </div>
        }
        <label class="control-label col-md-6" style="padding:50px;" id="idsucessstatus">@appstatus.displaystatus</label>

    </div>

</body>
</html>
<script>
    function BTNrejbymail() {

        debugger
        var reason = $("#txtRejreasonbymail").val();
        if (reason == "") {
            $app.showAlert('Please Enter the Reason for Rejection', 4);
        }
        else {
            EmailupdateLeaveStatus();
        }



    }
    function EmailupdateLeaveStatus() {
        debugger;
        $app.showProgressModel();

        $.ajax({
            type: 'POST',
            url: $app.baseUrl + "LeaveRequest/UpdateLeaveStatusThroughMail",
            contentType: "application/json; charset=utf-8",

            data: JSON.stringify({ ApporRejorcancStat: $('#hdnAorRstat').val(), prioritynumber: $('#hdnprioritynum').val(), AssignmanagerId: $('#hdnassgnmngrid').val(), Id: $('#hdnLeaveid').val(), dataValueRejectreason: $('#txtRejreasonbymail').val(), dataValueStatus: $('#hdnstatus').val(), NavTabStatus: $('#hdnNavTab').val() }),
            dataType: "json",
            success: function (jsonResult) {
                var out = jsonResult.result;
                switch (jsonResult.Status) {

                    case true:
                        debugger;
                        //$('#AddReason').modal('toggle');
                        $app.hideProgressModel();
                        $("#idrejectiondiv").addClass("nodisp");
                        document.getElementById('idsucessstatus').innerHTML = 'Leave Request Rejected Succesfully!!!';
                        break;
                    case false:
                        // $('#AddReason').modal('toggle');
                        $app.hideProgressModel();
                        $app.showAlert(jsonResult.Message, 4);
                        break;
                }

            },
            error: function (msg) {
            }
        });
    }
</script>


@{
    <script src="~/Js/Leave/leaveRequest.js"></script>}



