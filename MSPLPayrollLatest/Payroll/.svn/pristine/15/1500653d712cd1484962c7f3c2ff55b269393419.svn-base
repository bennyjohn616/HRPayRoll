<form id="frmUser" data-toggle="validator" role="form">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <input type="hidden" id="hdnCompId" value="@Session["CompanyId"]" />
                <button type="button" class="close" data-dismiss="modal">
                    &times;
                </button>
                <h4 class="modal-title" id="H4">
                    Add/Edit User
                </h4>
            </div>
            <div class="modal-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <label class="control-label col-md-3">
                            Employee Code
                        </label>
                        <div class="col-md-7">
                            <select id="sltEmployeeId" class="form-control" onchange="$User.GetRegData();" ></select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-3">
                            User Name <label style="color:red;font-size: 13px">*</label>
                        </label>
                        <div class="col-md-7">
                            <input type="text" id="txtUsername" class="form-control Reqrd" placeholder="Enter the User Name/EMail"  onchange="UserOrEmailAvailability()"
                                   maxlength="80" autofocus required  />
                            @*<label id="msgStatus"></label> onchange="UserOrEmailAvailability()"*@

                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">
                            Password <label style="color:red;font-size: 13px">*</label>
                        </label>
                        <div class="col-md-7">
                            <input type="password" id="txtPassword" class="form-control Reqrd" placeholder="Enter the Password"
                                   maxlength="25" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3" id="lblCNF">
                            Confirm Password <label style="color:red;font-size: 13px">*</label>
                        </label>
                        <div class="col-md-7">
                            <input type="password" id="txtCNFPassword" class="form-control Reqrd" placeholder="Confirm the Password"
                                   maxlength="25" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">
                            First Name <label style="color:red;font-size: 13px">*</label>
                        </label>
                        <div class="col-md-7">
                            <input type="text" id="txtFirstName" class="form-control Reqrd" placeholder="Enter the First Name"
                                   maxlength="30" required  />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">
                            Last Name <label style="color:red;font-size: 13px"></label>
                        </label>
                        <div class="col-md-7">
                            <input type="text" id="txtLastName" class="form-control" placeholder="Enter the Last Name"
                                   maxlength="25" required  />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">
                            E-mail
                        </label>
                        <div class="col-md-7">
                            <input type="email" id="txtEmail" class="form-control" placeholder="Enter the Email"  />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">
                            Phone
                        </label>
                        <div class="col-md-7">
                            <input type="text" id="txtPhone" onkeypress="return $validator.IsNumeric(event, this.id)" oncopy="return false" onpaste="return false" maxlength="10" class="form-control " placeholder="Enter the Phone No"  disabled/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-3">
                            User Role
                        </label>
                        <div class="col-md-7">
                            <select id="sltRolelist" class="form-control"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">
                          Employee  Login
                        </label>
                        <div class="col-md-7">
                            <label class="radio-inline">
                                <input type="radio" class="radio" id="rdUserActive" checked="checked" name="userlogin" /> Active
                            </label>
                            <label class="radio-inline">
                                <input type="radio" class="radio" id="rdUserInActive" name="userlogin" /> InActive
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="nodisp">
                            Access
                        </label>
                        <div class="col-md-4">
                            <select class="nodisp" id="ddcomponent" autofocus>
                                <option value="0">All</option>
                                <option value="CategoryId">Category</option>
                                <option value="Branch">Branch</option>
                                <option value="Designation">Designation</option>
                                <option value="CostCentre">Cost Centre</option>
                                <option value="ESILocation">ESI Location</option>
                                <option value="Grade">Grade</option>
                                <option value="ESIDespensary">ESI Dispensary</option>
                                <option value="Department">Department</option>
                                <option value="Location">Location</option>
                                <option value="PTLocation">PT Location</option>
                                <option value="Bank">Bank</option>
                            </select>
                        </div>
                        <div class="col-md-5">
                            <select class="nodisp" id="ddData"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3">
                            Profile Image
                        </label>
                        <div class="col-md-7">
                            <input type="file" id="txtprofile" name="File1" accept="image/*" class="form-control" placeholder="Select Profile Picture" />
                            <img id="imgUserProfileView" src="" class="img-circle img-inline" style="max-height:200px;max-width:200px;" />
                        </div>
                    </div>
                    <label class="control-label col-md-3">
                        Company List
                    </label>
                    <div class="row">
                        <div class="col-md-12 table-responsive" id="dvcompanygrid" align="center" style="height: 350px;">
                            <table id="tblCompanygrid" class="table table-responsive table-striped table-hover table-condensed userTablehand dataTable no-footer" style="width: 700px;">
                                <thead>
                                    <tr>
                                        <th class="nodisp">
                                        </th>
                                        <th>

                                        </th>
                                        <th>
                                            Company
                                        </th>
                                        <th>

                                        </th>
                                        <th>

                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>



                </div>
            </div>

            <div class="modal-footer">
                <button type="button" id="btnComponentSave" class="btn custom-button">
                    Save
                </button>
                <button type="button" class="btn custom-button" data-dismiss="modal">
                    Close
                </button>
            </div>
        </div>
    </div>
</form>
<script src="~/Js/Company/CompanyCom.js" type="text/javascript"></script>
<script src="~/Js/Admin/User.js" type="text/javascript"></script>
<script>
    $companyCom.loadEmployee({ id: 'sltEmployeeId' });
</script>
<script>
    $("#btnComponentSave").on('click', function (event) {

        var error = 0;
        $(".Reqrd").each(function () {

            if (document.getElementById(this.id).value == "") {

                $app.showAlert('Please ' + $(this).attr('placeholder'), 'danger');
                error = 1;
                return false;
            }
            //if ($("#txtCNFPassword").val() != "") {
            if ($("#txtPassword").val().trim() != $("#txtCNFPassword").val().trim()) {


                $app.showAlert('Password And Confirm Password Should be Same', 4);
                $("#txtCNFPassword").val('');
                $("#txtCNFPassword").focus();
                error = 1;
                return false;
            }
            //}
        });

        if (error == 0) {

            $User.save();
        }
    });
    function UserOrEmailAvailability() { //This function call on text change.             
        
        var username = $("#txtUsername").val();
        $.ajax({
            type: "POST",
            url: $app.baseUrl + 'Login/CheckEmail',// this for calling the web method function in cs code.  
            data: JSON.stringify({ useroremail: username }),// user name or email value  
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: OnSuccess,
            failure: function (response) {
                $app.showAlert(response, 4);
            }
        });
    }
    // function OnSuccess  
    function OnSuccess(response) {
               
        switch (response.result) {
            case true:
                $app.showAlert("Username Already Exist ", 4);
                $("#txtUsername").val('');
                $('#txtUsername').focus();
                break;
            case false:
                $app.showAlert("Username is avaliable", 2);               
                $('#txtUsername').focus();
                break;
        }
    }
</script>