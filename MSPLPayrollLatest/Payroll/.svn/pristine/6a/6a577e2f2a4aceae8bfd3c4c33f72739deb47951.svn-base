<!-- Modal -->
<form id="frmLockRelease" data-toggle="validator" role="form" action="javascript:$comPopup.save();">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    &times;
                </button>
                <h4 class="modal-title">
                    <label>Paysheet Lock and Release</label>
                </h4>
            </div>
            <div class="modal-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label class="control-label col-md-5">
                            Paysheet Lock
                        </label>
                        <div class="col-md-7">
                            <input type="checkbox" id="chkPaysheetLock" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-5">
                            Month for (Lock/Release) <label style="color:red;font-size: 13px">*</label>
                        </label>
                        <div class="col-md-6">
                            <select id="ddLockMonth" class="form-control Reqrd">
                                <option id="" value="0">--Select---</option>
                                <option id="1" value="1">January</option>
                                <option id="2" value="2">February</option>
                                <option id="3" value="3">March</option>
                                <option id="4" value="4">April</option>
                                <option id="5" value="5">May</option>
                                <option id="6" value="6">June</option>
                                <option id="7" value="7">July</option>
                                <option id="8" value="8">August</option>
                                <option id="9" value="9">September</option>
                                <option id="10" value="10">October</option>
                                <option id="11" value="11">November</option>
                                <option id="12" value="12">December</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-5">
                            Paysheet Year <label style="color:red;font-size: 13px">*</label>
                        </label>
                        <div class="col-md-6">
                            <input type="text" id="txtPaysheetLock" class="form-control Reqrd" onkeypress="return $validator.IsNumeric(event, this.id)" placeholder="Enter The Paysheet Year " maxlength="4" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-5">
                            Admin Password <label style="color:red;font-size: 13px">*</label>
                        </label>
                        <div class="col-md-6">
                            <input type="password" id="txtPaysheetAdminPass" class="form-control Reqrd" placeholder="Enter The Admin Password" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="height: 31px;">
                    <button type="button" id="btnPaysheetLock" class="btn custom-button" onclick="$setting.savelockrelease()">
                        Save
                    </button>
                    <button type="button" class="btn custom-button" data-dismiss="modal">
                        Close
                    </button>
                </div>
            </div>
        </div>
</form>
<script>
    $("#txtPaysheetLock").change(function () {
        
        var isnumeric = $.isNumeric($("#txtPaysheetLock").val());
        if ($("#txtPaysheetLock").val() != "" && isnumeric != false || $("#txtPaysheetLock").val() != null && isnumeric != false) {
            if ($("#ddLockMonth").val() != "0") {
                var PLPaySheetLockid = $setting.PaysheetLockId == "" ? '00000000-0000-0000-0000-000000000000' : $setting.PaysheetLockId;
                var PLPayrollMonth = $("#ddLockMonth").val();
                var PLPayrollYear = $("#txtPaysheetLock").val();
                var PLPayrollLock = $("#chkPaysheetLock").is(":checked");
                var PLAdminPassword = $("#txtPaysheetAdminPass").val();
                $.ajax({
                    url: $app.baseUrl + "Setting/SelectlockReleaseSetting",
                    data: JSON.stringify({ PaySheetLockid: PLPaySheetLockid, AdminPassword: PLAdminPassword, PayrollMonth: PLPayrollMonth, PayrollYear: PLPayrollYear, PayrollLock: PLPayrollLock }),
                    dataType: "json",
                    contentType: "application/json",
                    type: "POST",
                    success: function (jsonResult) {
                        
                        switch (jsonResult.Status) {
                            case true:
                                $setting.PaysheetLockId = jsonResult.result.PaySheetLockid;
                                $('#chkPaysheetLock').prop('checked', jsonResult.result.PayrollLock);
                                $app.hideProgressModel();
                                break;
                            case false:
                                $app.hideProgressModel();
                                $app.showAlert(jsonResult.Message, 4);
                                break;
                        }
                    },
                    complete: function () {
                        $app.hideProgressModel();
                    }
                });
            }
            else {
                $app.showAlert('Please Select paysheet month', 4);
                $("#txtPaysheetLock").val('');
            }
        }
    });
    $("#ddLockMonth").change(function () {
        
        var isnumeric = $.isNumeric($("#txtPaysheetLock").val());
        if ($("#txtPaysheetLock").val() != "" && isnumeric != false || $("#txtPaysheetLock").val() != null && isnumeric != false) {
            if ($("#ddLockMonth").val() != "0") {
                var PLPaySheetLockid = $setting.PaysheetLockId == "" ? '00000000-0000-0000-0000-000000000000' : $setting.PaysheetLockId;
                var PLPayrollMonth = $("#ddLockMonth").val();
                var PLPayrollYear = $("#txtPaysheetLock").val();
                var PLPayrollLock = $("#chkPaysheetLock").is(":checked");
                var PLAdminPassword = $("#txtPaysheetAdminPass").val();
                $.ajax({
                    url: $app.baseUrl + "Setting/SelectlockReleaseSetting",
                    data: JSON.stringify({ PaySheetLockid: PLPaySheetLockid, AdminPassword: PLAdminPassword, PayrollMonth: PLPayrollMonth, PayrollYear: PLPayrollYear, PayrollLock: PLPayrollLock }),
                    dataType: "json",
                    contentType: "application/json",
                    type: "POST",
                    success: function (jsonResult) {
                        
                        switch (jsonResult.Status) {
                            case true:
                                $setting.PaysheetLockId = jsonResult.result.PaySheetLockid;
                                $('#chkPaysheetLock').prop('checked', jsonResult.result.PayrollLock);
                                $app.hideProgressModel();
                                break;
                            case false:
                                $app.hideProgressModel();
                                $app.showAlert(jsonResult.Message, 4);
                                break;
                        }
                    },
                    complete: function () {
                        $app.hideProgressModel();
                    }
                });
            }
            else {
                $app.showAlert('Please Enter paysheet Year', 4);
                $("#txtPaysheetLock").val('');
            }
        }
    });
</script>